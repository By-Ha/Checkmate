<% 
let ads = [
  {url: 'https://kana-1252071452.cos.ap-shanghai.myqcloud.com/img/carousel/0913.jpg', link: 'tencent://Message/?Uin=2051261534', text: '广告位招租', expire: new Date('2333-3-3 3:33').getTime()},
  {url: 'https://kana-1252071452.cos.ap-shanghai.myqcloud.com/img/carousel/0913.jpg', link: 'https://kana.byha.top:444/post/14828', text: '未认证水贴区', expire: new Date('2333-3-3 3:33').getTime()},
] 
  let t = [];
  for(let i = 0;i<ads.length;++i){
    if(ads[i].expire < new Date().getTime()){ continue; }
    else t.push(ads[i]);
  }
  ads = t;
  ads.sort(function(){ return 0.5 - Math.random() });
%>
<div id="carousel-ad" class="carousel slide carousel-fade kana-item" data-ride="carousel">
  <ol class="carousel-indicators">
    <% for (let i = 0; i < ads.length; i++) { %>
    <li data-target="#carousel-ad" data-slide-to="<%= i %>" <%= i==0?"class=active":"" %>></li>
    <% } %>
  </ol>
  <div class="carousel-inner">

    <% for (let i = 0; i < ads.length; i++) { %>
    <div class="carousel-item <%= i==0?"active":"" %>" onclick="window.open('<%= ads[i].link %>')"
      style="background: url(<%= ads[i].url + '!h200' %>) , url(https://kana-1252071452.cos.ap-shanghai.myqcloud.com/img/carousel/background.png)">
      <% if(ads[i].text != undefined) { %>
      <div class="carousel-caption d-none d-md-block">
        <h3><%= ads[i].text %> </h3>
      </div>
      <% } %>
    </div>
    <% } %>

  </div>
  <a class="carousel-control-prev" href="#carousel-ad" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
  </a>
  <a class="carousel-control-next" href="#carousel-ad" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
  </a>
</div>
